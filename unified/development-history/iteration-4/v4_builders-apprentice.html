<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Builder's Apprentice - A Language Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            width: 100%;
            background: rgba(44, 62, 80, 0.95);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 2px solid #7f8c8d;
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #e67e22;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            text-align: center;
            font-style: italic;
            margin-bottom: 30px;
            color: #bdc3c7;
        }

        .intro-screen, .game-screen, .victory-screen {
            display: none;
        }

        .intro-screen.active, .game-screen.active, .victory-screen.active {
            display: block;
        }

        .quote {
            background: rgba(230, 126, 34, 0.1);
            border-left: 4px solid #e67e22;
            padding: 20px;
            margin: 20px 0;
            font-style: italic;
            border-radius: 5px;
        }

        .construction-site {
            background: rgba(52, 73, 94, 0.8);
            border: 3px solid #95a5a6;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            min-height: 300px;
            position: relative;
        }

        .builder {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 4em;
            animation: wave 2s infinite;
        }

        @keyframes wave {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        .blueprint {
            background: rgba(41, 128, 185, 0.1);
            border: 2px dashed #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2em;
        }

        .builder-request {
            background: linear-gradient(135deg, #e67e22, #d35400);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1.3em;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .vocabulary-panel {
            background: rgba(149, 165, 166, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .vocabulary-panel h3 {
            color: #e67e22;
            margin-bottom: 15px;
        }

        .word-list {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .word-item {
            background: rgba(230, 126, 34, 0.2);
            padding: 10px 20px;
            border-radius: 8px;
            border: 2px solid #e67e22;
            font-weight: bold;
            font-size: 1.1em;
        }

        .word-item.new {
            animation: glow 1s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px #e67e22; }
            50% { box-shadow: 0 0 20px #e67e22; }
        }

        .materials-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .material-card {
            background: rgba(149, 165, 166, 0.2);
            border: 3px solid #7f8c8d;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .material-card:hover {
            transform: scale(1.05);
            border-color: #e67e22;
            background: rgba(230, 126, 34, 0.2);
        }

        .material-card.locked {
            opacity: 0.3;
            cursor: not-allowed;
            filter: grayscale(100%);
        }

        .material-card.locked:hover {
            transform: none;
            border-color: #7f8c8d;
        }

        .material-icon {
            font-size: 4em;
            margin-bottom: 10px;
        }

        .material-name {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #ecf0f1;
        }

        .material-card.correct {
            border-color: #2ecc71;
            background: rgba(46, 204, 113, 0.2);
            animation: success-pulse 0.6s;
        }

        .material-card.incorrect {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.2);
            animation: shake 0.5s;
        }

        @keyframes success-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .structure-display {
            min-height: 200px;
            background: rgba(52, 152, 219, 0.1);
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .placed-material {
            font-size: 3em;
            animation: placeItem 0.5s;
        }

        @keyframes placeItem {
            0% { transform: translateY(-50px) scale(0); opacity: 0; }
            100% { transform: translateY(0) scale(1); opacity: 1; }
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
            line-height: 1.6;
        }

        .feedback.show {
            display: block;
        }

        .feedback.success {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
        }

        .feedback.error {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid #e74c3c;
        }

        .score-panel {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 20px;
            background: rgba(52, 73, 94, 0.5);
            border-radius: 10px;
        }

        .score-item {
            text-align: center;
        }

        .score-item .label {
            font-size: 0.9em;
            color: #bdc3c7;
            margin-bottom: 5px;
        }

        .score-item .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #e67e22;
        }

        button {
            padding: 15px 40px;
            font-size: 1.1em;
            background: #e67e22;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin: 10px;
            font-family: 'Courier New', monospace;
        }

        button:hover {
            background: #d35400;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 126, 34, 0.4);
        }

        .button-container {
            text-align: center;
            margin-top: 20px;
        }

        .stage-indicator {
            background: rgba(41, 128, 185, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            border: 2px solid #3498db;
        }

        .stage-indicator h3 {
            color: #3498db;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(127, 140, 141, 0.3);
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e67e22, #d35400);
            transition: width 0.5s;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Intro Screen -->
        <div class="intro-screen active">
            <h1>üèóÔ∏è The Builder's Apprentice</h1>
            <p class="subtitle">Learn Language Through Practice, Not Definition</p>

            <div class="quote">
                "One can imagine a language consisting only of orders and reports in battle... Or a language consisting only of questions and expressions for answering yes and no. And innumerable others."
                <br><br>
                <strong>‚Äî Ludwig Wittgenstein, Philosophical Investigations ¬ß19</strong>
            </div>

            <div style="margin: 30px 0; line-height: 1.8;">
                <p>You are an apprentice working with a builder. You don't know the language yet, but you'll learn through <strong>doing</strong>.</p>
                <br>
                <p>The builder will point and gesture, needing materials. You'll start with just 4 words: <strong>Block, Pillar, Slab, Beam</strong>.</p>
                <br>
                <p>As you successfully respond to the builder's needs, the language will naturally expand. New words emerge when new practices require them‚Äîjust as in real life.</p>
            </div>

            <div class="quote">
                <strong>Wittgenstein's Insight:</strong> The builder's assistant doesn't learn by memorizing definitions. They learn by participating in the practice‚Äîby successfully responding to "Slab!" with the right action. Meaning emerges from use.
            </div>

            <div class="button-container">
                <button onclick="startGame()">Begin Your Apprenticeship</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="game-screen">
            <h1>üèóÔ∏è The Builder's Apprentice</h1>

            <div class="score-panel">
                <div class="score-item">
                    <div class="label">Experience</div>
                    <div class="value" id="experience">0</div>
                </div>
                <div class="score-item">
                    <div class="label">Stage</div>
                    <div class="value" id="stage">1</div>
                </div>
                <div class="score-item">
                    <div class="label">Vocabulary</div>
                    <div class="value" id="vocabCount">4</div>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="vocabulary-panel">
                <h3>Your Vocabulary:</h3>
                <div class="word-list" id="wordList"></div>
            </div>

            <div class="stage-indicator" id="stageIndicator">
                <h3>Foundation Stage</h3>
                <p>The builder is laying the foundation. Basic materials only.</p>
            </div>

            <div class="construction-site">
                <div class="builder">üë∑</div>
                <div class="structure-display" id="structureDisplay"></div>
            </div>

            <div class="builder-request" id="builderRequest">
                The builder points to the foundation and gestures for rectangular building blocks...
            </div>

            <div class="materials-grid" id="materialsGrid"></div>

            <div class="feedback" id="feedback"></div>

            <div class="button-container">
                <button onclick="nextTask()" id="nextButton" style="display: none;">Next Task ‚Üí</button>
            </div>
        </div>

        <!-- Victory Screen -->
        <div class="victory-screen">
            <h1>üéì Master Builder!</h1>

            <div class="quote">
                "We have constructed a complete building!"
                <br><br>
                <strong>‚Äî You've learned language through practice</strong>
            </div>

            <div class="score-panel">
                <div class="score-item">
                    <div class="label">Final Experience</div>
                    <div class="value" id="finalExperience">0</div>
                </div>
                <div class="score-item">
                    <div class="label">Vocabulary Mastered</div>
                    <div class="value" id="finalVocab">0</div>
                </div>
            </div>

            <div class="construction-site">
                <div class="structure-display" id="finalStructure"></div>
            </div>

            <div style="margin: 30px 0; line-height: 1.8; background: rgba(230, 126, 34, 0.1); padding: 20px; border-radius: 10px;">
                <h3 style="color: #e67e22; margin-bottom: 15px;">What You've Learned:</h3>
                <p><strong>Learning Through Doing:</strong> You didn't memorize definitions‚Äîyou learned by successfully responding to the builder's needs.</p>
                <br>
                <p><strong>Meaning as Use:</strong> Each word gained meaning through its role in the building practice, not through abstract definition.</p>
                <br>
                <p><strong>Language Grows Organically:</strong> New words emerged when new building needs arose‚Äîlanguage expands with practice.</p>
                <br>
                <p><strong>Primitive Language Games:</strong> Even the simplest language game (4 words!) shows how meaning works‚Äîthrough shared activity, not inner mental definitions.</p>
            </div>

            <div class="button-container">
                <button onclick="location.reload()">Start New Apprenticeship</button>
            </div>
        </div>
    </div>

    <script>
        const gameState = {
            experience: 0,
            stage: 1,
            taskIndex: 0,
            vocabulary: ['Block', 'Pillar', 'Slab', 'Beam'],
            structure: []
        };

        const stages = [
            {
                name: "Foundation Stage",
                description: "The builder is laying the foundation. Basic materials only.",
                materials: ['Block', 'Pillar', 'Slab', 'Beam'],
                tasks: [
                    {
                        description: "The builder points to the foundation and gestures for rectangular building blocks...",
                        correct: "Block",
                        icon: "üß±",
                        explanation: "In this context, 'Block' means 'bring me rectangular blocks for the foundation.' You learned this not through definition, but through the builder's gesture and the situation."
                    },
                    {
                        description: "The builder gestures upward, needing vertical supports for the structure...",
                        correct: "Pillar",
                        icon: "‚ñå",
                        explanation: "'Pillar' here functions as a command: bring vertical supports. The meaning emerges from the building practice‚Äîthe gesture, the stage of construction."
                    },
                    {
                        description: "The builder is working on the floor, pointing to where large flat pieces are needed...",
                        correct: "Slab",
                        icon: "‚ñ¨",
                        explanation: "'Slab!' means 'bring flat pieces for the floor.' This isn't definition‚Äîit's learned response through participation in the building activity."
                    }
                ]
            },
            {
                name: "Wall Construction",
                description: "Building the walls. You've learned the basic vocabulary through practice!",
                materials: ['Block', 'Pillar', 'Slab', 'Beam'],
                tasks: [
                    {
                        description: "The builder points to the top of the pillars, needing horizontal support beams...",
                        correct: "Beam",
                        icon: "‚îÅ",
                        explanation: "'Beam!' means horizontal supports. You understand this because you've been participating in the building practice‚Äîthe word's meaning is its use here."
                    },
                    {
                        description: "More walls are needed. The builder gestures for more rectangular blocks...",
                        correct: "Block",
                        icon: "üß±",
                        explanation: "You've learned 'Block' through repeated practice. The word doesn't 'mean' anything separate from its use in this building activity."
                    }
                ]
            },
            {
                name: "Specialized Construction",
                description: "The building is becoming more complex. New materials are needed!",
                materials: ['Block', 'Pillar', 'Slab', 'Beam', 'Window', 'Door'],
                newWords: ['Window', 'Door'],
                tasks: [
                    {
                        description: "The builder points to a wall opening and mimes looking through it...",
                        correct: "Window",
                        icon: "ü™ü",
                        explanation: "A new word! 'Window' entered the language game because a new need arose. The practice expanded, so the vocabulary expanded naturally with it."
                    },
                    {
                        description: "The builder gestures to the entrance, miming opening and closing...",
                        correct: "Door",
                        icon: "üö™",
                        explanation: "'Door' emerged from a new building need. Language grows organically with practice‚Äîyou don't learn definitions, you learn by doing."
                    },
                    {
                        description: "Another opening for light and air is needed...",
                        correct: "Window",
                        icon: "ü™ü",
                        explanation: "You're already using 'Window' naturally! You learned it through practice, not by memorizing what a window 'is.'"
                    }
                ]
            },
            {
                name: "Finishing Touches",
                description: "The building is nearly complete. Final specialized elements needed.",
                materials: ['Block', 'Pillar', 'Slab', 'Beam', 'Window', 'Door', 'Roof', 'Stairs'],
                newWords: ['Roof', 'Stairs'],
                tasks: [
                    {
                        description: "The builder points upward at the top of the building, miming covering from rain...",
                        correct: "Roof",
                        icon: "üè†",
                        explanation: "'Roof' joins your vocabulary naturally. The language game expanded because the building practice required it. Meaning through use!"
                    },
                    {
                        description: "The builder gestures a climbing motion between floors...",
                        correct: "Stairs",
                        icon: "ü™ú",
                        explanation: "'Stairs' emerged from a practical need. You've witnessed how language grows: not through definitions, but through expanding practices."
                    },
                    {
                        description: "Final roofing materials needed to complete the top...",
                        correct: "Roof",
                        icon: "üè†",
                        explanation: "The building is nearly complete! You've learned an entire language game through participation, not study."
                    }
                ]
            }
        ];

        let currentStage = stages[0];
        let currentTask = null;

        function startGame() {
            document.querySelector('.intro-screen').classList.remove('active');
            document.querySelector('.game-screen').classList.add('active');
            loadTask();
        }

        function loadTask() {
            // Check if we've completed all stages
            if (gameState.stage > stages.length) {
                showVictory();
                return;
            }

            currentStage = stages[gameState.stage - 1];

            // Check if there are new words to add
            if (currentStage.newWords) {
                currentStage.newWords.forEach(word => {
                    if (!gameState.vocabulary.includes(word)) {
                        gameState.vocabulary.push(word);
                    }
                });
            }

            // Get current task
            const stageTaskIndex = gameState.taskIndex - stages.slice(0, gameState.stage - 1).reduce((sum, s) => sum + s.tasks.length, 0);

            if (stageTaskIndex >= currentStage.tasks.length) {
                // Move to next stage
                gameState.stage++;
                loadTask();
                return;
            }

            currentTask = currentStage.tasks[stageTaskIndex];

            // Update UI
            document.getElementById('stageIndicator').innerHTML = `
                <h3>${currentStage.name}</h3>
                <p>${currentStage.description}</p>
            `;

            document.getElementById('builderRequest').textContent = currentTask.description;

            updateVocabulary();
            createMaterialCards();
            updateProgress();
            updateScore();

            document.getElementById('feedback').classList.remove('show');
            document.getElementById('nextButton').style.display = 'none';
        }

        function updateVocabulary() {
            const wordList = document.getElementById('wordList');
            wordList.innerHTML = '';

            gameState.vocabulary.forEach((word, index) => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';

                // Check if this is a newly added word
                if (currentStage.newWords && currentStage.newWords.includes(word)) {
                    const stageTaskIndex = gameState.taskIndex - stages.slice(0, gameState.stage - 1).reduce((sum, s) => sum + s.tasks.length, 0);
                    if (stageTaskIndex === 0) {
                        wordItem.classList.add('new');
                    }
                }

                wordItem.textContent = word;
                wordList.appendChild(wordItem);
            });

            document.getElementById('vocabCount').textContent = gameState.vocabulary.length;
        }

        function createMaterialCards() {
            const grid = document.getElementById('materialsGrid');
            grid.innerHTML = '';

            // Shuffle available materials
            const shuffled = [...currentStage.materials].sort(() => Math.random() - 0.5);

            shuffled.forEach(material => {
                const card = document.createElement('div');
                card.className = 'material-card';

                // Icon mapping
                const icons = {
                    'Block': 'üß±',
                    'Pillar': '‚ñå',
                    'Slab': '‚ñ¨',
                    'Beam': '‚îÅ',
                    'Window': 'ü™ü',
                    'Door': 'üö™',
                    'Roof': 'üè†',
                    'Stairs': 'ü™ú'
                };

                card.innerHTML = `
                    <div class="material-icon">${icons[material]}</div>
                    <div class="material-name">${material}</div>
                `;

                card.onclick = () => selectMaterial(material, card);
                grid.appendChild(card);
            });
        }

        function selectMaterial(material, card) {
            const cards = document.querySelectorAll('.material-card');
            cards.forEach(c => c.onclick = null);

            const feedback = document.getElementById('feedback');

            if (material === currentTask.correct) {
                card.classList.add('correct');
                gameState.structure.push(currentTask.icon);

                feedback.className = 'feedback success show';
                feedback.innerHTML = `
                    <strong>‚úì Correct!</strong> You brought ${material}.
                    <br><br>
                    ${currentTask.explanation}
                `;

                gameState.experience += 100;

                // Update structure display
                const structureDisplay = document.getElementById('structureDisplay');
                const item = document.createElement('div');
                item.className = 'placed-material';
                item.textContent = currentTask.icon;
                structureDisplay.appendChild(item);

            } else {
                card.classList.add('incorrect');
                cards.forEach(c => {
                    if (c.querySelector('.material-name').textContent === currentTask.correct) {
                        c.classList.add('correct');
                    }
                });

                feedback.className = 'feedback error show';
                feedback.innerHTML = `
                    <strong>Not quite.</strong> The builder needed ${currentTask.correct}.
                    <br><br>
                    ${currentTask.explanation}
                `;

                gameState.experience += 25;
            }

            updateScore();
            document.getElementById('nextButton').style.display = 'inline-block';
        }

        function nextTask() {
            gameState.taskIndex++;
            loadTask();
        }

        function updateScore() {
            document.getElementById('experience').textContent = gameState.experience;
            document.getElementById('stage').textContent = gameState.stage;
        }

        function updateProgress() {
            const totalTasks = stages.reduce((sum, stage) => sum + stage.tasks.length, 0);
            const progress = (gameState.taskIndex / totalTasks) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showVictory() {
            document.querySelector('.game-screen').classList.remove('active');
            document.querySelector('.victory-screen').classList.add('active');

            document.getElementById('finalExperience').textContent = gameState.experience;
            document.getElementById('finalVocab').textContent = gameState.vocabulary.length;

            // Show final structure
            const finalStructure = document.getElementById('finalStructure');
            finalStructure.innerHTML = gameState.structure.map(icon =>
                `<div class="placed-material">${icon}</div>`
            ).join('');
        }
    </script>
</body>
</html>
